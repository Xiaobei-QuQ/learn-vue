{"version":3,"sources":["webpack:///src/views/message.vue","webpack:///./src/views/message.vue?22b3","webpack:///./src/views/message.vue"],"names":["message","data","showMenu","selectItem","noData","currentData","no_read_len","computed","extends_default","Object","vuex_esm","userInfo","mounted","_this","this","jquery_default","a","get","token","d","hasnot_read_messages","length","has_read_messages","methods","changeItem","idx","markall","post","accesstoken","success","window","location","reload","getLastTimeStr","date","friendly","utils","components","nvHead","header","views_message","render","_vm","_h","$createElement","_c","_self","staticStyle","height","attrs","page-type","fix-head","show-menu","message-count","need-add","need-res","_v","staticClass","class","selected","on","click","$event","directives","name","rawName","value","expression","_l","item","src","author","avatar_url","_s","loginname","type","_e","domProps","textContent","reply","create_at","innerHTML","content","to","params","id","topic","title","staticRenderFns","Component","__webpack_require__","normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/8.61161d677c28d9ad28f3.js","sourcesContent":["<template>\n    <div style=\"height: 100%\">\n        <nv-head page-type=\"消息\"\n                :fix-head=\"true\"\n                :show-menu=\"showMenu\"\n                :message-count=\"no_read_len\"\n                :need-add=\"false\"\n                 :need-res=\"true\"></nv-head>\n        <div class=\"page\" >\n            <ul class=\"tabs\">\n                <li class=\"item br\" :class='{\"selected\":selectItem === 2}' @click=\"changeItem(2)\">已读消息</li>\n                <li class=\"item\" :class='{\"selected\":selectItem === 1}' @click=\"changeItem(1)\">\n                    未读消息\n                    <i class=\"iconfont read\" v-show=\"no_read_len > 0\"\n                        @click=\"markall\">&#xe60c;</i>\n                </li>\n            </ul>\n            <div class=\"message markdown-body\" v-for=\"(item, idx) in currentData\">\n                <section class=\"user\">\n                    <img class=\"head\" :src=\"item.author.avatar_url\" />\n                    <div class=\"info\">\n                        <span class=\"cl\">\n                            <span class=\"name\">{{item.author.loginname}}</span>\n                            <span class=\"name\" v-if=\"item.type==='at'\">在回复中@了您</span>\n                            <span class=\"name\" v-if=\"item.type==='reply'\">回复了您的话题</span>\n                        </span>\n                        <span class=\"cr\">\n                            <span class=\"name\" v-text=\"getLastTimeStr(item.reply.create_at, true)\"></span>\n                        </span>\n                    </div>\n                </section>\n                <div class=\"reply_content\" v-html=\"item.reply.content\"></div>\n                <router-link :to=\"{name:'topic',params:{id:item.topic.id}}\">\n                    <div class=\"topic-title\">\n                        话题：{{item.topic.title}}\n                    </div>\n                </router-link>\n            </div>\n            <div class=\"no-data\" v-show=\"noData\">\n                <i class=\"iconfont icon-empty\">&#xe60a;</i>\n                暂无数据!\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n    import $ from 'jquery';\n    import * as utils from '../libs/utils.js';\n    import nvHead from '../components/header.vue';\n    import {\n        mapGetters\n    } from 'vuex';\n\n    export default {\n        data() {\n            return {\n                showMenu: false,\n                selectItem: 2,\n                message: {},\n                noData: false,\n                currentData: [],\n                no_read_len: 0\n            };\n        },\n        computed: {\n          // 使用对象展开运算符将 getter 混入 computed 对象中\n            ...mapGetters({\n                userInfo: 'getUserInfo'\n            })\n        },\n        mounted() {\n            $.get('https://cnodejs.org/api/v1/messages?accesstoken=' + this.userInfo.token, (d) => {\n                if (d && d.data) {\n                    this.message = d.data;\n                    this.no_read_len = d.data.hasnot_read_messages.length;\n                    if (d.data.hasnot_read_messages.length > 0) {\n                        this.currentData = d.data.hasnot_read_messages;\n                    } else {\n                        this.currentData = d.data.has_read_messages;\n                        this.selectItem = 2;\n                    }\n                    this.noData = this.currentData.length === 0;\n                } else {\n                    this.noData = true;\n                }\n            });\n        },\n        methods: {\n            // 切换tab\n            changeItem(idx) {\n                this.selectItem = idx;\n                this.currentData = idx === 1 ? this.message.hasnot_read_messages : this.message.has_read_messages;\n                this.noData = this.currentData.length === 0;\n            },\n            // 标记所有为已读\n            markall() {\n                $.post('https://cnodejs.org/api/v1/message/mark_all', {\n                    accesstoken: this.userInfo.token\n                }, (d) => {\n                    if (d && d.success) {\n                        window.location.reload();\n                    }\n                });\n            },\n            getLastTimeStr(date, friendly) {\n                return utils.getLastTimeStr(date, friendly);\n            }\n        },\n        components: {\n            nvHead\n        }\n    };\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/views/message.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"height\":\"100%\"}},[_c('nv-head',{attrs:{\"page-type\":\"消息\",\"fix-head\":true,\"show-menu\":_vm.showMenu,\"message-count\":_vm.no_read_len,\"need-add\":false,\"need-res\":true}}),_vm._v(\" \"),_c('div',{staticClass:\"page\"},[_c('ul',{staticClass:\"tabs\"},[_c('li',{staticClass:\"item br\",class:{\"selected\":_vm.selectItem === 2},on:{\"click\":function($event){_vm.changeItem(2)}}},[_vm._v(\"已读消息\")]),_vm._v(\" \"),_c('li',{staticClass:\"item\",class:{\"selected\":_vm.selectItem === 1},on:{\"click\":function($event){_vm.changeItem(1)}}},[_vm._v(\"\\n                未读消息\\n                \"),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.no_read_len > 0),expression:\"no_read_len > 0\"}],staticClass:\"iconfont read\",on:{\"click\":_vm.markall}},[_vm._v(\"\")])])]),_vm._v(\" \"),_vm._l((_vm.currentData),function(item,idx){return _c('div',{staticClass:\"message markdown-body\"},[_c('section',{staticClass:\"user\"},[_c('img',{staticClass:\"head\",attrs:{\"src\":item.author.avatar_url}}),_vm._v(\" \"),_c('div',{staticClass:\"info\"},[_c('span',{staticClass:\"cl\"},[_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(item.author.loginname))]),_vm._v(\" \"),(item.type==='at')?_c('span',{staticClass:\"name\"},[_vm._v(\"在回复中@了您\")]):_vm._e(),_vm._v(\" \"),(item.type==='reply')?_c('span',{staticClass:\"name\"},[_vm._v(\"回复了您的话题\")]):_vm._e()]),_vm._v(\" \"),_c('span',{staticClass:\"cr\"},[_c('span',{staticClass:\"name\",domProps:{\"textContent\":_vm._s(_vm.getLastTimeStr(item.reply.create_at, true))}})])])]),_vm._v(\" \"),_c('div',{staticClass:\"reply_content\",domProps:{\"innerHTML\":_vm._s(item.reply.content)}}),_vm._v(\" \"),_c('router-link',{attrs:{\"to\":{name:'topic',params:{id:item.topic.id}}}},[_c('div',{staticClass:\"topic-title\"},[_vm._v(\"\\n                    话题：\"+_vm._s(item.topic.title)+\"\\n                \")])])],1)}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.noData),expression:\"noData\"}],staticClass:\"no-data\"},[_c('i',{staticClass:\"iconfont icon-empty\"},[_vm._v(\"\")]),_vm._v(\"\\n            暂无数据!\\n        \")])],2)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-c87747a6\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/message.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./message.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./message.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-c87747a6\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./message.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/message.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}